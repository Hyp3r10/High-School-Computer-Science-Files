import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Scanner;

public class LinearTester {
	public static void main(String[] args) throws IOException {
		ArrayList<String> names = new ArrayList<String>();
		ArrayList<Integer> IDs = new ArrayList<Integer>();
		Scanner scan = new Scanner(new File("Large Data Set.txt"));
		while(scan.hasNextLine()) {
			String[] parts = scan.nextLine().split(" ");
			IDs.add(Integer.parseInt(parts[0]));
			names.add(parts[1] + " " + parts[2]);
		}
		double a = 0.50;
		double buildTableTimer = System.currentTimeMillis();
		EmployeeDatabaseLinear linearTester = new EmployeeDatabaseLinear(names.size() + (int)(names.size() * a));
		for(int i = 0; i < names.size(); i++) {
			linearTester.put(IDs.get(i), names.get(i));
		}
		buildTableTimer = (System.currentTimeMillis() - buildTableTimer) / 1000.0;
		
		double successfulSerchTimer = System.currentTimeMillis();
		scan = new Scanner(new File("Successful Search Records.txt"));
		
		
		
		
		PrintWriter out = new PrintWriter(new File("Linear Tester.out"));
		out.println("Linear Probling");
		out.println();
		out.println("Number of records added to the table: " + linearTester.size + "\tTable Size: " + linearTester.hashTable.length + "\tLoad Factor: " + a);
		out.println("Total Insertion Time: " + buildTableTimer + "\t" + "Average Insertion time per element: " + buildTableTimer / linearTester.size);
		out.println("Total Table Insertion Collisions: " + linearTester.collisionCounter  + "\tAverage Table Insertion Collisions: " + (double) linearTester.collisionCounter / linearTester.size);
		out.println("Number of collisions vs. Number of Insertsions: "  + (double) (linearTester.collisionCounter / linearTester.size) * 100 + "%");
		out.close();
	}
}
